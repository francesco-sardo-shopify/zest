import{w as x}from"./with-props-C97DBiG3.js";import{j as e}from"./jsx-runtime-BjG_zV1W.js";import{r as h,v as u,s as f,q as s}from"./chunk-AYJ5UCUI-pMwHqBCg.js";import{getAllBooks as p}from"./db-Dghpep6g.js";import{T as g}from"./TopBar-C2zSAFsJ.js";function y({}){return[{title:"Zest - Your EPUB Reader"},{name:"description",content:"Welcome to Zest!"}]}async function k({context:i}){return{books:await p()}}const C=x(function({loaderData:a}){const{books:n}=a,r=h.useRef(null),o=u(),c=(t,l)=>{t.preventDefault(),t.stopPropagation(),confirm("Are you sure you want to delete this book?")&&o(null,{method:"DELETE",action:s("/books/:bookId",{bookId:l})})},d=t=>{if(t.target.files&&t.target.files.length>0){const l=new FormData;l.append("epubFile",t.target.files[0]),o(l,{method:"POST",action:s("/books/new"),encType:"multipart/form-data"})}};return e.jsxs("div",{className:"flex flex-col min-h-screen",children:[e.jsx(g,{currentPage:"library"}),e.jsx("input",{type:"file",ref:r,onChange:d,accept:".epub",className:"hidden",name:"epubFile"}),e.jsxs("main",{className:"flex-grow container mx-auto px-4 py-6 mt-14",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Your Library"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"flex flex-col overflow-hidden rounded-lg border-2 border-dashed border-gray-300 hover:bg-gray-50 transition-colors duration-200 cursor-pointer",onClick:()=>{var t;return(t=r.current)==null?void 0:t.click()},children:[e.jsx("div",{className:"relative pb-[150%] w-full bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("svg",{className:"w-16 h-16 text-blue-500 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),e.jsx("span",{className:"text-blue-500 font-medium text-xl",children:"Add a new book"})]})}),e.jsx("div",{className:"p-4 bg-white flex-grow",children:e.jsx("span",{className:"text-sm text-gray-500",children:"Click to upload an EPUB file"})})]}),n.map(t=>{var l;return e.jsxs(f,{to:s("/books/:bookId",{bookId:t.id}),className:"flex flex-col overflow-hidden rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300 relative",children:[e.jsx("div",{className:"relative pb-[150%] bg-gray-200",children:e.jsx("img",{src:URL.createObjectURL(t.cover),alt:`Cover for ${t.title}`,className:"absolute top-0 left-0 w-full h-full object-cover"})}),e.jsxs("div",{className:"p-4 bg-white flex-grow",children:[e.jsx("h3",{className:"font-semibold text-gray-800 line-clamp-2",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.authors.join(", ")}),((l=t.location)==null?void 0:l.percentage)&&t.location.percentage>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"h-1.5 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 rounded-full",style:{width:`${t.location.percentage*100}%`}})}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[Math.round(t.location.percentage*100),"% completed"]})]})]}),e.jsx("button",{onClick:m=>c(m,t.id),className:"absolute bottom-2 right-2 p-1.5 bg-white rounded-full shadow hover:bg-red-50 transition-colors","aria-label":`Delete ${t.title}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4 text-red-500",children:e.jsx("path",{fillRule:"evenodd",d:"M16.5 4.478v.227a48.816 48.816 0 013.878.512.75.75 0 11-.256 1.478l-.209-.035-1.005 13.07a3 3 0 01-2.991 2.77H8.084a3 3 0 01-2.991-2.77L4.087 6.66l-.209.035a.75.75 0 01-.256-1.478A48.567 48.567 0 017.5 4.705v-.227c0-1.564 1.213-2.9 2.816-2.951a52.662 52.662 0 013.369 0c1.603.051 2.815 1.387 2.815 2.951zm-6.136-1.452a51.196 51.196 0 013.273 0C14.39 3.05 15 3.684 15 4.478v.113a49.488 49.488 0 00-6 0v-.113c0-.794.609-1.428 1.364-1.452zm-.355 5.945a.75.75 0 10-1.5.058l.347 9a.75.75 0 101.499-.058l-.346-9zm5.48.058a.75.75 0 10-1.498-.058l-.347 9a.75.75 0 001.5.058l.345-9z",clipRule:"evenodd"})})})]},t.id)})]})]})]})});export{k as clientLoader,C as default,y as meta};
